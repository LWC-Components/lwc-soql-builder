<template>
  <div class="app">
    <div>
      <header class="slds-builder-header">
        <div class="slds-builder-header__item">
          <div class="slds-builder-header__item-label slds-media slds-media_center">
            <div class="slds-media__figure">
              <span class="slds-icon_container slds-icon-utility-builder slds-current-color">
                <svg class="slds-icon slds-icon_x-small" aria-hidden="true">
                  <use xlink:href="./resources/slds/icons/utility-sprite/svg/symbols.svg#builder"></use>
                </svg>
              </span>
            </div>
            <div class="slds-media__body">LWC SOQL Buidler</div>
          </div>
        </div>
        <div class="slds-builder-header__item slds-builder-header__utilities">
          <div class="slds-builder-header__utilities-item" if:false={isLoggedIn}>
            <a href="javascript:void(0);" class="slds-builder-header__item-action slds-media slds-media_center" onclick={login}>
              <div class="slds-media__figure">
                <span class="slds-icon_container slds-icon-utility-forward slds-current-color">
                  <svg class="slds-icon slds-icon_x-small" aria-hidden="true">
                    <use xlink:href="./resources/slds/icons/utility-sprite/svg/symbols.svg#forward"></use>
                  </svg>
                </span>
              </div>
              <div class="slds-media__body">Login</div>
            </a>
          </div>
          <div class="slds-builder-header__utilities-item" if:true={isLoggedIn}>
            <a href="javascript:void(0);" class="slds-builder-header__item-action slds-media slds-media_center" onclick={logout}>
              <div class="slds-media__figure">
                <span class="slds-icon_container slds-icon-utility-logout slds-current-color">
                  <svg class="slds-icon slds-icon_x-small" aria-hidden="true">
                    <use xlink:href="./resources/slds/icons/utility-sprite/svg/symbols.svg#logout"></use>
                  </svg>
                </span>
              </div>
              <div class="slds-media__body">Logout</div>
            </a>
          </div>
          <div class="slds-builder-header__utilities-item">
            <a href="javascript:void(0);" class="slds-builder-header__item-action slds-media slds-media_center">
              <div class="slds-media__figure">
                <span class="slds-icon_container slds-icon-utility-help slds-current-color">
                  <svg class="slds-icon slds-icon_x-small" aria-hidden="true">
                    <use xlink:href="./resources/slds/icons/utility-sprite/svg/symbols.svg#help"></use>
                  </svg>
                </span>
              </div>
              <div class="slds-media__body">Help</div>
            </a>
          </div>
        </div>
      </header>
    </div>
    <div class="body">
      <div class="left-panel">
        <nav class="slds-nav-vertical" aria-label="Sub page">
          <div class="slds-form-element slds-p-horizontal_large slds-p-top_small">
            <label class="slds-form-element__label slds-assistive-text">Filter navigation items</label>
            <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_left">
              <span class="slds-icon_container slds-icon-utility-search">
                <svg class="slds-icon slds-input__icon slds-input__icon_right slds-icon-text-default" aria-hidden="true">
                  <use xlink:href="./resources/slds/icons/utility-sprite/svg/symbols.svg#search"></use>
                </svg>
              </span>
              <input type="search" placeholder="Quick Find" class="slds-input" onkeyup={filterSObjects} />
            </div>
          </div>
          <div class="slds-nav-vertical__section">
            <h2 id="entity-header" class="slds-nav-vertical__title slds-border_bottom">SObjects</h2>
            <ul class="left-panel-scrollable" aria-describedby="entity-header" if:true={filteredSObjects}>
              <template for:each={filteredSObjects} for:item="sobject">
                <li class="slds-nav-vertical__item slds-border_bottom" key={sobject.name} if:true={sobject.queryable}>
                  <a href="javascript:void(0);" class="slds-nav-vertical__action">{sobject.name} / {sobject.label}</a>
                </li>
              </template>
            </ul>
          </div>
        </nav>
      </div>
      <div class="right-panel">
        <div class="right-top-panel">
          <div class="right-top-left-panel">
            <div class="slds-p-around_small">
              <button class="slds-button slds-button_neutral" onclick={executeSOQL}>Execute SOQL</button>
              <button class="slds-button slds-button_neutral">Save SOQL</button>
            </div>
            <div class="soql-editor slds-p-horizontal_small slds-p-bottom_small">
              <textarea class="slds-textarea soql-input" placeholder="Input SOQL"></textarea>
            </div>
          </div>
          <div class="right-top-right-panel">
            <div class="slds-tabs_default">
              <ul class="slds-tabs_default__nav" role="tablist">
                <li class="slds-tabs_default__item slds-is-active" title="Item One" role="presentation">
                  <a class="slds-tabs_default__link" href="javascript:void(0);" role="tab" tabindex="0" aria-selected="true" aria-controls="tab-scoped-1" id="tab-scoped-1__item">Saved Queries</a>
                </li>
                <li class="slds-tabs_default__item" title="Item Two" role="presentation">
                  <a class="slds-tabs_default__link" href="javascript:void(0);" role="tab" tabindex="-1" aria-selected="false" aria-controls="tab-scoped-2" id="tab-scoped-2__item">Recent Queries</a>
                </li>
              </ul>
              <div id="tab-scoped-1" class="slds-tabs_default__content slds-p-around_none slds-show" role="tabpanel" aria-labelledby="tab-scoped-1__item">
                <div class="slds-p-around_small slds-border_bottom slds-truncate">
                  SELECT AccountNumber, AccountSource, AnnualRevenue, BillingAddress, BillingGeocodeAccuracy, ChannelProgramLevelName, ChannelProgramName, CleanStatus, CreatedById, CreatedDate, DandbCompanyId, Description, DunsNumber, Fax, Id, Industry, IsCustomerPortal, IsDeleted, IsPartner, Jigsaw, JigsawCompanyId, LastActivityDate, LastModifiedById, LastModifiedDate, LastReferencedDate, LastViewedDate, MasterRecordId, NaicsCode, NaicsDesc, Name, NumberOfEmployees, OwnerId, Ownership, ParentId, Phone, PhotoUrl, Rating, RecordTypeId, SystemModstamp, TickerSymbol, Tradestyle, Type, Website, YearStarted FROM Account
                </div>
                <div class="slds-p-around_small slds-border_bottom slds-truncate">
                  SELECT AccountNumber, AccountSource, AnnualRevenue, BillingAddress, BillingGeocodeAccuracy, ChannelProgramLevelName, ChannelProgramName, CleanStatus, CreatedById, CreatedDate, DandbCompanyId, Description, DunsNumber, Fax, Id, Industry, IsCustomerPortal, IsDeleted, IsPartner, Jigsaw, JigsawCompanyId, LastActivityDate, LastModifiedById, LastModifiedDate, LastReferencedDate, LastViewedDate, MasterRecordId, NaicsCode, NaicsDesc, Name, NumberOfEmployees, OwnerId, Ownership, ParentId, Phone, PhotoUrl, Rating, RecordTypeId, SystemModstamp, TickerSymbol, Tradestyle, Type, Website, YearStarted FROM Account
                </div>
              </div>
              <div id="tab-scoped-2" class="slds-tabs_default__content slds-hide" role="tabpanel" aria-labelledby="tab-scoped-2__item">
                <div class="slds-p-around_small slds-border_top slds-truncate">
                  SELECT AccountNumber, AccountSource, AnnualRevenue, BillingAddress, BillingGeocodeAccuracy, ChannelProgramLevelName, ChannelProgramName, CleanStatus, CreatedById, CreatedDate, DandbCompanyId, Description, DunsNumber, Fax, Id, Industry, IsCustomerPortal, IsDeleted, IsPartner, Jigsaw, JigsawCompanyId, LastActivityDate, LastModifiedById, LastModifiedDate, LastReferencedDate, LastViewedDate, MasterRecordId, NaicsCode, NaicsDesc, Name, NumberOfEmployees, OwnerId, Ownership, ParentId, Phone, PhotoUrl, Rating, RecordTypeId, SystemModstamp, TickerSymbol, Tradestyle, Type, Website, YearStarted FROM Account
                </div>
                <div class="slds-p-around_small slds-border_top slds-truncate">
                  SELECT AccountNumber, AccountSource, AnnualRevenue, BillingAddress, BillingGeocodeAccuracy, ChannelProgramLevelName, ChannelProgramName, CleanStatus, CreatedById, CreatedDate, DandbCompanyId, Description, DunsNumber, Fax, Id, Industry, IsCustomerPortal, IsDeleted, IsPartner, Jigsaw, JigsawCompanyId, LastActivityDate, LastModifiedById, LastModifiedDate, LastReferencedDate, LastViewedDate, MasterRecordId, NaicsCode, NaicsDesc, Name, NumberOfEmployees, OwnerId, Ownership, ParentId, Phone, PhotoUrl, Rating, RecordTypeId, SystemModstamp, TickerSymbol, Tradestyle, Type, Website, YearStarted FROM Account
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="right-bottom-panel">
          <template if:true={output}>
            <div class="slds-p-around_small slds-grid">
              <button class="slds-button slds-button_neutral">Export CSV</button>
              <div class="slds-p-around_x-small slds-col_bump-left">Total: {output.totalSize}</div>
            </div>
            <div class="output-panel">
              <div class="output-panel-scrollable">
                <table class="slds-table slds-table_bordered slds-table_col-bordered slds-table_striped">
                  <thead>
                    <tr class="slds-line-height_reset">
                      <template for:each={output.columns} for:item="column">
                        <th class="" scope="col" key={column}>
                          <div class="slds-truncate" title={column}>{column}</div>
                        </th>
                      </template>
                    </tr>
                  </thead>
                  <tbody>
                    <template for:each={output.rows} for:item="row">
                      <tr class="slds-hint-parent" key={row.key}>
                        <template for:each={row.values} for:item="value">
                          <td key={value.key}>
                            <div class="slds-truncate" title={value.data}>{value.data}</div>
                          </td>
                        </template>
                      </tr>
                    </template>
                  </tbody>
                </table>
              </div>
            </div>
          </template>
        </div>
      </div>
    </div>
  </div>
</template>
