<template>
  <nav class="slds-nav-vertical" aria-label="Sub page">
    <div class="slds-p-left_small">
      <div class="slds-grid">
        <button class="slds-button slds-button_icon" title="Back" onclick={deselectSObject}>
          <svg class="slds-button__icon" aria-hidden="true">
            <use xlink:href="./resources/slds/icons/utility-sprite/svg/symbols.svg#back"></use>
          </svg>
          <span class="slds-assistive-text">Back</span>
        </button>
        <h2 class="slds-nav-vertical__title slds-p-left_x-small slds-truncate" if:true={sobjectMeta}>
          {sobjectMeta.name} / {sobjectMeta.label}
        </h2>
      </div>
    </div>
    <div class="slds-form-element slds-p-horizontal_large">
      <label class="slds-form-element__label slds-assistive-text">Filter fields</label>
      <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_left">
        <span class="slds-icon_container slds-icon-utility-search">
          <svg class="slds-icon slds-input__icon slds-input__icon_right slds-icon-text-default" aria-hidden="true">
            <use xlink:href="./resources/slds/icons/utility-sprite/svg/symbols.svg#search"></use>
          </svg>
        </span>
        <input type="search" placeholder="Quick Find" class="slds-input" onkeyup={filterFields} />
      </div>
    </div>
    <div class="slds-nav-vertical__section">
      <div class="slds-tabs_default sobject-tabs">
        <ul class="slds-tabs_default__nav" role="tablist">
          <template for:each={tabs} for:item="tab">
            <li class="slds-tabs_default__item slds-is-active" title={tab.label} key={tab.id} if:true={tab.isActive}>
              <a class="slds-tabs_default__link" role="tab" tabindex="-1" onclick={selectTab} data-id={tab.id}>{tab.label}</a>
            </li>
            <li class="slds-tabs_default__item" title={tab.label} key={tab.id} if:false={tab.isActive}>
              <a class="slds-tabs_default__link" role="tab" tabindex="-1" onclick={selectTab} data-id={tab.id}>{tab.label}</a>
            </li>
          </template>
        </ul>
        <div class="slds-tabs_default__content" role="tabpanel" if:true={isFieldsActive}>
          <ul class="left-panel-scrollable" aria-describedby="entity-header">
            <template for:each={fields} for:item="field">
              <li class="slds-nav-vertical__item slds-is-active" key={field.name} if:true={field.isActive}>
                <a class="slds-nav-vertical__action slds-truncate" title={field.name}
                  onclick={selectField} data-name={field.name}>
                  {field.name} / {field.label}
                </a>
              </li>
              <li class="slds-nav-vertical__item" key={field.name} if:false={field.isActive}>
                <a class="slds-nav-vertical__action slds-truncate" title={field.name}
                  onclick={selectField} data-name={field.name}>
                  {field.name} / {field.label}
                </a>
              </li>
            </template>
          </ul>
        </div>
        <div class="slds-tabs_default__content" role="tabpanel" if:true={isRelationshipsActive}>
          <ul class="left-panel-scrollable" aria-describedby="entity-header">
            <template for:each={relationships} for:item="relation">
              <template if:true={relation.relationshipName}>
                <li class="slds-nav-vertical__item slds-is-active" key={relation.relationshipName} if:true={relation.isActive}>
                  <a class="slds-nav-vertical__action slds-truncate" title={relation.relationshipName}
                    onclick={selectRelationship} data-name={relation.relationshipName}>
                    {relation.relationshipName} / {relation.childSObject}
                  </a>
                </li>
                <li class="slds-nav-vertical__item" key={relation.relationshipName} if:false={relation.isActive}>
                  <a class="slds-nav-vertical__action slds-truncate" title={relation.relationshipName}
                    onclick={selectRelationship} data-name={relation.relationshipName}>
                    {relation.relationshipName} / {relation.childSObject}
                  </a>
                </li>
              </template>
            </template>
          </ul>
        </div>
      </div>
    </div>
  </nav>
</template>